import{d as s,o as a,c as e,a as o}from"./@vue.1f188819.js";const p={class:"markdown-body"},c=o(`<h2>\u51C6\u5907</h2><ol><li><code>Loading</code> \u7EC4\u4EF6</li><li>\u5F53\u52A0\u8F7D\u5931\u8D25\u65F6\u663E\u793A\u7684\u56FE\u7247 <code>picError.jpg</code></li></ol><h2>\u9700\u6C42</h2><p><strong>\u652F\u6301\u63A7\u5236\u662F\u5426\u61D2\u52A0\u8F7D\uFF0C\u53EF\u4EE5\u4F20\u5165\u4E00\u4E2A\u6216\u591A\u4E2A<code>src</code>\u5730\u5740\uFF0C\u4F9D\u6B21\u5C1D\u8BD5\u52A0\u8F7D\uFF0C\u6210\u529F\u540E\u4E0D\u518D\u7EE7\u7EED\u52A0\u8F7D\u540E\u9762\u7684\uFF0C\u5F53\u5747\u4E0D\u80FD\u52A0\u8F7D\u65F6\u4F7F\u7528\u9ED8\u8BA4\u7684\u56FE\u7247\uFF0C\u540C\u65F6\u4E5F\u53EF\u4EE5\u624B\u52A8\u4F20\u5165\u9ED8\u8BA4\u7684\u56FE\u7247</strong></p><h2>\u5B9E\u73B0</h2><p>\u4E3B\u8981\u903B\u8F91\u91C7\u7528 Image \u52A0\u8F7D\u7684\u5F62\u5F0F\uFF1A</p><div class="code-wrapper"><div class="heading-row no-heading show-lang"><span class="lang-display">js</span></div><div class="code-block language-javascript no-line-numbers" data-lang="js" data-modifiers=""><pre class="language-javascript" data-lang="js"><code class="code-line odd first-row line-1"><span class="token comment">/**</span></code>
<code class="code-line even line-2"> <span class="token operator">*</span> </code>
<code class="code-line odd line-3"> <span class="token operator">*</span> @param <span class="token punctuation">{</span>Array<span class="token punctuation">}</span> srcs \u56FE\u7247\u94FE\u63A5\u6570\u7EC4</code>
<code class="code-line even line-4"> <span class="token operator">*</span> @<span class="token keyword">return</span> <span class="token punctuation">{</span>Promise<span class="token punctuation">}</span></code>
<code class="code-line odd line-5"> <span class="token operator">*</span><span class="token operator">/</span></code>
<code class="code-line even line-6"><span class="token keyword">function</span> <span class="token function">trySrcs</span><span class="token punctuation">(</span><span class="token parameter">srcs</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code>
<code class="code-line odd line-7">  <span class="token keyword">const</span> promises <span class="token operator">=</span> srcs<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">src</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-8">      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code>
<code class="code-line odd line-9">          <span class="token comment">// \u901A\u8FC7 Image \u52A0\u8F7D</span></code>
<code class="code-line even line-10">          <span class="token keyword">const</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code>
<code class="code-line odd line-11">          img<span class="token punctuation">.</span>src <span class="token operator">=</span> src</code>
<code class="code-line even line-12">          img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code>
<code class="code-line odd line-13">              <span class="token function">resolve</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span></code>
<code class="code-line even line-14">          <span class="token punctuation">}</span></code>
<code class="code-line odd line-15">          img<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-16">              <span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code>
<code class="code-line odd line-17">          <span class="token punctuation">}</span></code>
<code class="code-line even line-18">      <span class="token punctuation">}</span><span class="token punctuation">)</span></code>
<code class="code-line odd line-19">  <span class="token punctuation">}</span><span class="token punctuation">)</span></code>
<code class="code-line even line-20">  <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">any</span><span class="token punctuation">(</span>promises<span class="token punctuation">)</span></code>
<code class="code-line odd last-row line-21"><span class="token punctuation">}</span></code></pre></div></div><br><p>\u5728\u81EA\u5B9A\u4E49\u7684 <code>Picture.vue</code> \u4E2D\uFF1A</p><div class="code-wrapper"><div class="heading-row no-heading show-lang"><span class="lang-display">js</span></div><div class="code-block language-javascript no-line-numbers" data-lang="js" data-modifiers=""><pre class="language-javascript" data-lang="js"><code class="code-line odd first-row line-1"><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span></code>
<code class="code-line even line-2"><span class="token keyword">import</span> Loading <span class="token keyword">from</span> <span class="token string">&#39;./Loading.vue&#39;</span></code>
<code class="code-line odd line-3"><span class="token keyword">import</span> picError <span class="token keyword">from</span> <span class="token string">&#39;../../assets/picError.jpg&#39;</span></code>
<code class="code-line even line-4"></code>
<code class="code-line odd line-5"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-6">  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code>
<code class="code-line odd line-7">    <span class="token keyword">return</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-8">      <span class="token literal-property property">isLoading</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></code>
<code class="code-line odd line-9">      <span class="token literal-property property">srcs</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span></code>
<code class="code-line even line-10">      <span class="token literal-property property">imgSrc</span><span class="token operator">:</span> <span class="token string">&#39;&#39;</span></code>
<code class="code-line odd line-11">    <span class="token punctuation">}</span></code>
<code class="code-line even line-12">  <span class="token punctuation">}</span><span class="token punctuation">,</span></code>
<code class="code-line odd line-13">  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-14">    <span class="token literal-property property">lazy</span><span class="token operator">:</span> <span class="token punctuation">{</span></code>
<code class="code-line odd line-15">      <span class="token literal-property property">type</span><span class="token operator">:</span> Boolean<span class="token punctuation">,</span></code>
<code class="code-line even line-16">      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token boolean">false</span></code>
<code class="code-line odd line-17">    <span class="token punctuation">}</span><span class="token punctuation">,</span></code>
<code class="code-line even line-18">    <span class="token literal-property property">src</span><span class="token operator">:</span> <span class="token punctuation">{</span></code>
<code class="code-line odd line-19">      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token punctuation">[</span>String<span class="token punctuation">,</span> Array<span class="token punctuation">]</span><span class="token punctuation">,</span></code>
<code class="code-line even line-20">    <span class="token punctuation">}</span><span class="token punctuation">,</span></code>
<code class="code-line odd line-21">    <span class="token literal-property property">defaultSrc</span><span class="token operator">:</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-22">      <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span></code>
<code class="code-line odd line-23">      <span class="token keyword">default</span><span class="token operator">:</span> picError</code>
<code class="code-line even line-24">    <span class="token punctuation">}</span></code>
<code class="code-line odd line-25">  <span class="token punctuation">}</span><span class="token punctuation">,</span></code>
<code class="code-line even line-26">  <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">{</span> Loading <span class="token punctuation">}</span><span class="token punctuation">,</span></code>
<code class="code-line odd line-27">   <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-28">    <span class="token function">loadImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code>
<code class="code-line odd line-29">      <span class="token function">trySrcs</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>srcs<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">src</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-30">          <span class="token keyword">this</span><span class="token punctuation">.</span>imgSrc <span class="token operator">=</span> result</code>
<code class="code-line odd line-31">      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-32">          <span class="token keyword">this</span><span class="token punctuation">.</span>imgSrc <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>defaultSrc</code>
<code class="code-line odd line-33">      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-34">          <span class="token keyword">this</span><span class="token punctuation">.</span>isLoading <span class="token operator">=</span> <span class="token boolean">false</span></code>
<code class="code-line odd line-35">      <span class="token punctuation">}</span><span class="token punctuation">)</span></code>
<code class="code-line even line-36">    <span class="token punctuation">}</span><span class="token punctuation">,</span></code>
<code class="code-line odd line-37">  <span class="token punctuation">}</span><span class="token punctuation">,</span></code>
<code class="code-line even line-38">  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code>
<code class="code-line odd line-39">    <span class="token keyword">const</span> srcs <span class="token operator">=</span> <span class="token function">clone</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>src<span class="token punctuation">)</span></code>
<code class="code-line even line-40">    <span class="token keyword">this</span><span class="token punctuation">.</span>srcs <span class="token operator">=</span> srcs <span class="token keyword">instanceof</span> <span class="token class-name">Array</span> <span class="token operator">?</span> srcs <span class="token operator">:</span> <span class="token punctuation">[</span>srcs<span class="token punctuation">]</span></code>
<code class="code-line odd line-41">  <span class="token punctuation">}</span><span class="token punctuation">,</span></code>
<code class="code-line even line-42">  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code>
<code class="code-line odd line-43">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>lazy<span class="token punctuation">)</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-44">      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code>
<code class="code-line odd line-45">    <span class="token punctuation">}</span></code>
<code class="code-line even line-46">    <span class="token keyword">const</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IntersectionObserver</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">entries<span class="token punctuation">,</span> observer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code>
<code class="code-line odd line-47">      entries<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">entery</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-48">        <span class="token keyword">if</span> <span class="token punctuation">(</span>entery<span class="token punctuation">.</span>isIntersecting<span class="token punctuation">)</span> <span class="token punctuation">{</span></code>
<code class="code-line odd line-49">          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code>
<code class="code-line even line-50">          observer<span class="token punctuation">.</span><span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code>
<code class="code-line odd line-51">        <span class="token punctuation">}</span></code>
<code class="code-line even line-52">      <span class="token punctuation">}</span></code>
<code class="code-line odd line-53">      <span class="token punctuation">)</span></code>
<code class="code-line even line-54">    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span></code>
<code class="code-line odd line-55">      <span class="token literal-property property">threshold</span><span class="token operator">:</span> <span class="token number">0.1</span><span class="token punctuation">,</span></code>
<code class="code-line even line-56">    <span class="token punctuation">}</span><span class="token punctuation">)</span></code>
<code class="code-line odd line-57">    observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">)</span></code>
<code class="code-line even line-58">  <span class="token punctuation">}</span></code>
<code class="code-line odd line-59"><span class="token punctuation">}</span></code>
<code class="code-line even line-60"><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span></code>
<code class="code-line odd line-61"></code>
<code class="code-line even line-62"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span></code>
<code class="code-line odd line-63">  <span class="token operator">&lt;</span>div <span class="token operator">:</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;$style.container&quot;</span><span class="token operator">&gt;</span></code>
<code class="code-line even line-64">    <span class="token operator">&lt;</span>Loading v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;isLoading&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span></code>
<code class="code-line odd line-65">    <span class="token operator">&lt;</span>img <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">&quot;imgSrc&quot;</span> v<span class="token operator">-</span><span class="token keyword">else</span> <span class="token operator">/</span><span class="token operator">&gt;</span></code>
<code class="code-line even line-66">  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></code>
<code class="code-line odd line-67"><span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span></code>
<code class="code-line even line-68"></code>
<code class="code-line odd line-69"><span class="token operator">&lt;</span>style module<span class="token operator">&gt;</span></code>
<code class="code-line even line-70"><span class="token punctuation">.</span>container <span class="token punctuation">{</span></code>
<code class="code-line odd line-71">  <span class="token literal-property property">display</span><span class="token operator">:</span> flex<span class="token punctuation">;</span></code>
<code class="code-line even line-72">  align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span></code>
<code class="code-line odd line-73">  justify<span class="token operator">-</span>content<span class="token operator">:</span> center<span class="token punctuation">;</span></code>
<code class="code-line even line-74">  <span class="token literal-property property">position</span><span class="token operator">:</span> relative<span class="token punctuation">;</span></code>
<code class="code-line odd line-75"><span class="token punctuation">}</span></code>
<code class="code-line even line-76"></code>
<code class="code-line odd line-77"><span class="token punctuation">.</span>container img <span class="token punctuation">{</span></code>
<code class="code-line even line-78">  object<span class="token operator">-</span>fit<span class="token operator">:</span> cover<span class="token punctuation">;</span></code>
<code class="code-line odd line-79">  <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span></code>
<code class="code-line even line-80">  <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span></code>
<code class="code-line odd line-81"><span class="token punctuation">}</span></code>
<code class="code-line even last-row line-82"><span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span></code></pre></div></div>`,10),t=[c],r={title:null,tags:["lazyload","\u56FE\u7247\u61D2\u52A0\u8F7D"],categories:null,description:"\u56FE\u7247\u52A0\u8F7D\u8FC7\u7A0B\u4E2D\u663E\u793A\u52A0\u8F7D\u6837\u5F0F\uFF0C\u52A0\u8F7D\u6210\u529F\u663E\u793A\u6210\u529F\u7684\u56FE\u7247\uFF0C\u52A0\u8F7D\u5931\u8D25\u663E\u793A\u9ED8\u8BA4\u7684\u56FE\u7247",publishTime:"2022-08-17T00:10:35.000Z",updateTime:"2022-08-26T01:34:40.000Z",img:null,toc:!0},k="",y=s({__name:"index",setup(l,{expose:n}){return n({frontmatter:{title:null,tags:["lazyload","\u56FE\u7247\u61D2\u52A0\u8F7D"],categories:null,description:"\u56FE\u7247\u52A0\u8F7D\u8FC7\u7A0B\u4E2D\u663E\u793A\u52A0\u8F7D\u6837\u5F0F\uFF0C\u52A0\u8F7D\u6210\u529F\u663E\u793A\u6210\u529F\u7684\u56FE\u7247\uFF0C\u52A0\u8F7D\u5931\u8D25\u663E\u793A\u9ED8\u8BA4\u7684\u56FE\u7247",publishTime:"2022-08-17T00:10:35.000Z",updateTime:"2022-08-26T01:34:40.000Z",img:null,toc:!0},excerpt:void 0}),(u,i)=>(a(),e("div",p,t))}});export{y as default,k as excerpt,r as frontmatter};
