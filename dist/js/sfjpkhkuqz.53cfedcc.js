import{d as s,o as a,c as e,a as o}from"./@vue.25a72e45.js";const t={class:"markdown-body"},p=o(`<h2>\u76F4\u63A5\u8C03\u7528\u5373\u53EF!</h2><div class="code-wrapper"><div class="heading-row no-heading show-lang"><span class="lang-display">js</span></div><div class="code-block language-javascript no-line-numbers" data-lang="js" data-modifiers=""><pre class="language-javascript" data-lang="js"><code class="code-line odd first-row line-1"><span class="token comment">/**</span></code>
<code class="code-line even line-2"> <span class="token operator">*</span> \u70B9\u51FB\u4E0A\u4F20 <span class="token operator">|</span> \u62D6\u62FD\u4E0A\u4F20 </code>
<code class="code-line odd line-3"> <span class="token operator">*</span> \u5355\u6587\u4EF6 <span class="token operator">|</span> \u591A\u6587\u4EF6 <span class="token operator">|</span> \u6587\u4EF6\u5939</code>
<code class="code-line even line-4"> <span class="token operator">*</span><span class="token operator">/</span></code>
<code class="code-line odd line-5"><span class="token keyword">class</span> <span class="token class-name">uploader</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-6">  el <span class="token operator">=</span> <span class="token keyword">null</span></code>
<code class="code-line odd line-7">  pattern <span class="token operator">=</span> <span class="token keyword">null</span></code>
<code class="code-line even line-8">  options <span class="token operator">=</span> <span class="token keyword">null</span></code>
<code class="code-line odd line-9">  acceptType <span class="token operator">=</span> <span class="token keyword">null</span></code>
<code class="code-line even line-10">  callback <span class="token operator">=</span> <span class="token keyword">null</span></code>
<code class="code-line odd line-11">  <span class="token comment">/**</span></code>
<code class="code-line even line-12">   <span class="token operator">*</span> @param <span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token literal-property property">el</span><span class="token operator">:</span> HTMLElement<span class="token punctuation">,</span> <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&quot;Click&quot;</span><span class="token operator">|</span><span class="token string">&quot;Drag&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">pattern</span><span class="token operator">:</span> <span class="token string">&quot;SingleFile&quot;</span><span class="token operator">|</span><span class="token string">&quot;MultiFile&quot;</span><span class="token operator">|</span><span class="token string">&quot;Folder&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">acceptType</span> <span class="token operator">:</span> String <span class="token punctuation">,</span> <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">onDragEnter</span><span class="token operator">:</span> Function<span class="token punctuation">,</span> <span class="token literal-property property">onDragOver</span><span class="token operator">:</span> Function<span class="token punctuation">,</span> <span class="token literal-property property">onDragLeave</span><span class="token operator">:</span> Function<span class="token punctuation">,</span> <span class="token literal-property property">onDrop</span><span class="token operator">:</span> Function <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span> config</code>
<code class="code-line odd line-13">   <span class="token operator">*</span> @param <span class="token punctuation">{</span>Function<span class="token punctuation">}</span> callback</code>
<code class="code-line even line-14">   <span class="token operator">*</span><span class="token operator">/</span></code>
<code class="code-line odd line-15">  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">config<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-16">    <span class="token keyword">const</span> <span class="token punctuation">{</span> el<span class="token punctuation">,</span> mode<span class="token punctuation">,</span> pattern<span class="token punctuation">,</span> acceptType<span class="token punctuation">,</span> options <span class="token punctuation">}</span> <span class="token operator">=</span> config</code>
<code class="code-line odd line-17">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>el<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;no element!&quot;</span><span class="token punctuation">)</span></code>
<code class="code-line even line-18">    <span class="token keyword">this</span><span class="token punctuation">.</span>el <span class="token operator">=</span> el</code>
<code class="code-line odd line-19">    <span class="token keyword">this</span><span class="token punctuation">.</span>pattern <span class="token operator">=</span> pattern <span class="token operator">||</span> <span class="token string">&quot;SingleFile&quot;</span></code>
<code class="code-line even line-20">    <span class="token keyword">this</span><span class="token punctuation">.</span>options <span class="token operator">=</span> options <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code>
<code class="code-line odd line-21">    <span class="token keyword">this</span><span class="token punctuation">.</span>acceptType <span class="token operator">=</span> acceptType <span class="token operator">||</span> <span class="token string">&quot;&quot;</span></code>
<code class="code-line even line-22">    <span class="token keyword">this</span><span class="token punctuation">.</span>callback <span class="token operator">=</span> callback</code>
<code class="code-line odd line-23">    <span class="token keyword">switch</span> <span class="token punctuation">(</span>mode <span class="token operator">||</span> <span class="token string">&quot;Click&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-24">      <span class="token keyword">case</span> <span class="token string">&quot;Click&quot;</span><span class="token operator">:</span></code>
<code class="code-line odd line-25">        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">clickModeFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code>
<code class="code-line even line-26">        <span class="token keyword">break</span></code>
<code class="code-line odd line-27">      <span class="token keyword">case</span> <span class="token string">&quot;Drag&quot;</span><span class="token operator">:</span></code>
<code class="code-line even line-28">        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">dragModeFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code>
<code class="code-line odd line-29">        <span class="token keyword">break</span></code>
<code class="code-line even line-30">      <span class="token keyword">default</span><span class="token operator">:</span></code>
<code class="code-line odd line-31">        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;mode not accepted!&quot;</span><span class="token punctuation">)</span></code>
<code class="code-line even line-32">    <span class="token punctuation">}</span></code>
<code class="code-line odd line-33">  <span class="token punctuation">}</span></code>
<code class="code-line even line-34"></code>
<code class="code-line odd line-35">  <span class="token function">watchElRemove</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-36">    <span class="token keyword">const</span> parentNode <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>el<span class="token punctuation">.</span>parentNode</code>
<code class="code-line odd line-37">    <span class="token keyword">const</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MutationObserver</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">mutationsList<span class="token punctuation">,</span> observer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-38">      mutationsList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code>
<code class="code-line odd line-39">        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>parentNode<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>el<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-40">          callback <span class="token operator">&amp;&amp;</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code>
<code class="code-line odd line-41">          <span class="token keyword">this</span><span class="token punctuation">.</span>el <span class="token operator">=</span> <span class="token keyword">null</span></code>
<code class="code-line even line-42">          observer<span class="token punctuation">.</span><span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code>
<code class="code-line odd line-43">        <span class="token punctuation">}</span></code>
<code class="code-line even line-44">      <span class="token punctuation">}</span><span class="token punctuation">)</span></code>
<code class="code-line odd line-45">    <span class="token punctuation">}</span><span class="token punctuation">)</span></code>
<code class="code-line even line-46">    observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>parentNode<span class="token punctuation">,</span> <span class="token punctuation">{</span></code>
<code class="code-line odd line-47">      <span class="token literal-property property">childList</span><span class="token operator">:</span> <span class="token boolean">true</span></code>
<code class="code-line even line-48">    <span class="token punctuation">}</span><span class="token punctuation">)</span></code>
<code class="code-line odd line-49">  <span class="token punctuation">}</span></code>
<code class="code-line even line-50"></code>
<code class="code-line odd line-51">  <span class="token function">clickModeFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-52">    <span class="token keyword">const</span> inputFile <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;input&quot;</span><span class="token punctuation">)</span></code>
<code class="code-line odd line-53">    inputFile<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;file&quot;</span><span class="token punctuation">)</span></code>
<code class="code-line even line-54">    <span class="token keyword">this</span><span class="token punctuation">.</span>acceptType <span class="token operator">&amp;&amp;</span> inputFile<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;accept&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>acceptType<span class="token punctuation">)</span></code>
<code class="code-line odd line-55">    inputFile<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&quot;none&quot;</span></code>
<code class="code-line even line-56">    <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>pattern<span class="token punctuation">)</span> <span class="token punctuation">{</span></code>
<code class="code-line odd line-57">      <span class="token keyword">case</span> <span class="token string">&quot;SingleFile&quot;</span><span class="token operator">:</span></code>
<code class="code-line even line-58">        <span class="token keyword">break</span></code>
<code class="code-line odd line-59">      <span class="token keyword">case</span> <span class="token string">&quot;MultiFile&quot;</span><span class="token operator">:</span></code>
<code class="code-line even line-60">        inputFile<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;multiple&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span></code>
<code class="code-line odd line-61">        <span class="token keyword">break</span></code>
<code class="code-line even line-62">      <span class="token keyword">case</span> <span class="token string">&quot;Folder&quot;</span><span class="token operator">:</span></code>
<code class="code-line odd line-63">        inputFile<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;webkitdirectory&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span></code>
<code class="code-line even line-64">        <span class="token keyword">break</span></code>
<code class="code-line odd line-65">      <span class="token keyword">default</span><span class="token operator">:</span></code>
<code class="code-line even line-66">        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;pattern not accepted!&quot;</span><span class="token punctuation">)</span></code>
<code class="code-line odd line-67">    <span class="token punctuation">}</span></code>
<code class="code-line even line-68"></code>
<code class="code-line odd line-69">    <span class="token keyword">const</span> <span class="token function-variable function">changeHandle</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> target <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-70">      <span class="token keyword">let</span> values <span class="token operator">=</span> <span class="token keyword">null</span></code>
<code class="code-line odd line-71">      <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>pattern<span class="token punctuation">)</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-72">        <span class="token keyword">case</span> <span class="token string">&quot;SingleFile&quot;</span><span class="token operator">:</span></code>
<code class="code-line odd line-73">          values <span class="token operator">=</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-74">            <span class="token literal-property property">file</span><span class="token operator">:</span> target<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span></code>
<code class="code-line odd line-75">            <span class="token literal-property property">path</span><span class="token operator">:</span> target<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name</code>
<code class="code-line even line-76">          <span class="token punctuation">}</span></code>
<code class="code-line odd line-77">          <span class="token keyword">break</span></code>
<code class="code-line even line-78">        <span class="token keyword">case</span> <span class="token string">&quot;MultiFile&quot;</span><span class="token operator">:</span></code>
<code class="code-line odd line-79">          values <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>files<span class="token punctuation">,</span> <span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span></code>
<code class="code-line even line-80">            <span class="token literal-property property">file</span><span class="token operator">:</span> item<span class="token punctuation">,</span></code>
<code class="code-line odd line-81">            <span class="token literal-property property">path</span><span class="token operator">:</span> item<span class="token punctuation">.</span>name</code>
<code class="code-line even line-82">          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code>
<code class="code-line odd line-83">          <span class="token keyword">break</span></code>
<code class="code-line even line-84">        <span class="token keyword">case</span> <span class="token string">&quot;Folder&quot;</span><span class="token operator">:</span></code>
<code class="code-line odd line-85">          values <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>files<span class="token punctuation">,</span> <span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span></code>
<code class="code-line even line-86">            <span class="token literal-property property">file</span><span class="token operator">:</span> item<span class="token punctuation">,</span></code>
<code class="code-line odd line-87">            <span class="token literal-property property">path</span><span class="token operator">:</span> item<span class="token punctuation">.</span>webkitRelativePath</code>
<code class="code-line even line-88">          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code>
<code class="code-line odd line-89">          <span class="token keyword">break</span></code>
<code class="code-line even line-90">      <span class="token punctuation">}</span></code>
<code class="code-line odd line-91">      <span class="token keyword">this</span><span class="token punctuation">.</span>callback <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">callback</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span></code>
<code class="code-line even line-92">      target<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">&quot;&quot;</span></code>
<code class="code-line odd line-93">    <span class="token punctuation">}</span></code>
<code class="code-line even line-94"></code>
<code class="code-line odd line-95">    inputFile<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;change&quot;</span><span class="token punctuation">,</span> changeHandle<span class="token punctuation">)</span></code>
<code class="code-line even line-96">    <span class="token keyword">this</span><span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>inputFile<span class="token punctuation">)</span></code>
<code class="code-line odd line-97">    <span class="token keyword">const</span> <span class="token function-variable function">clickHandle</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> inputFile<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span></code>
<code class="code-line even line-98">    <span class="token keyword">this</span><span class="token punctuation">.</span>el<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> clickHandle<span class="token punctuation">)</span></code>
<code class="code-line odd line-99">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">watchElRemove</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-100">      inputFile<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;change&quot;</span><span class="token punctuation">,</span> changeHandle<span class="token punctuation">)</span></code>
<code class="code-line odd line-101">      inputFile<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code>
<code class="code-line even line-102">      <span class="token keyword">this</span><span class="token punctuation">.</span>el<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> clickHandle<span class="token punctuation">)</span></code>
<code class="code-line odd line-103">    <span class="token punctuation">}</span><span class="token punctuation">)</span></code>
<code class="code-line even line-104">  <span class="token punctuation">}</span></code>
<code class="code-line odd line-105"></code>
<code class="code-line even line-106">  <span class="token function">dragModeFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code>
<code class="code-line odd line-107">    <span class="token keyword">const</span> <span class="token punctuation">{</span> onDragEnter<span class="token punctuation">,</span> onDragOver<span class="token punctuation">,</span> onDragLeave<span class="token punctuation">,</span> onDrop <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options</code>
<code class="code-line even line-108"></code>
<code class="code-line odd line-109">    <span class="token keyword">const</span> <span class="token function-variable function">getFileFromFolder</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">entry<span class="token punctuation">,</span> path</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-110">      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code>
<code class="code-line odd line-111">        <span class="token keyword">if</span> <span class="token punctuation">(</span>entry<span class="token punctuation">.</span>isFile<span class="token punctuation">)</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-112">          entry<span class="token punctuation">.</span><span class="token function">file</span><span class="token punctuation">(</span><span class="token parameter">file</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code>
<code class="code-line odd line-113">            <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">[</span></code>
<code class="code-line even line-114">              <span class="token punctuation">{</span></code>
<code class="code-line odd line-115">                <span class="token literal-property property">file</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token punctuation">[</span>file<span class="token punctuation">]</span><span class="token punctuation">,</span> file<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> file<span class="token punctuation">.</span>type <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span></code>
<code class="code-line even line-116">                <span class="token literal-property property">path</span><span class="token operator">:</span> path <span class="token operator">+</span> file<span class="token punctuation">.</span>name</code>
<code class="code-line odd line-117">              <span class="token punctuation">}</span></code>
<code class="code-line even line-118">            <span class="token punctuation">]</span><span class="token punctuation">)</span></code>
<code class="code-line odd line-119">          <span class="token punctuation">}</span><span class="token punctuation">)</span></code>
<code class="code-line even line-120">        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>entry<span class="token punctuation">.</span>isDirectory<span class="token punctuation">)</span> <span class="token punctuation">{</span></code>
<code class="code-line odd line-121">          <span class="token keyword">const</span> dirReader <span class="token operator">=</span> entry<span class="token punctuation">.</span><span class="token function">createReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code>
<code class="code-line even line-122">          dirReader<span class="token punctuation">.</span><span class="token function">readEntries</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token parameter">entries</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code>
<code class="code-line odd line-123">            <span class="token keyword">const</span> files <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></code>
<code class="code-line even line-124">            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> item <span class="token keyword">of</span> entries<span class="token punctuation">)</span> <span class="token punctuation">{</span></code>
<code class="code-line odd line-125">              files<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token function">getFileFromFolder</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> path <span class="token operator">+</span> entry<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code>
<code class="code-line even line-126">            <span class="token punctuation">}</span></code>
<code class="code-line odd line-127">            <span class="token function">resolve</span><span class="token punctuation">(</span>files<span class="token punctuation">)</span></code>
<code class="code-line even line-128">          <span class="token punctuation">}</span><span class="token punctuation">)</span></code>
<code class="code-line odd line-129">        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-130">          <span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">&quot;The file type is not supported!&quot;</span><span class="token punctuation">)</span></code>
<code class="code-line odd line-131">        <span class="token punctuation">}</span></code>
<code class="code-line even line-132">      <span class="token punctuation">}</span><span class="token punctuation">)</span></code>
<code class="code-line odd line-133"></code>
<code class="code-line even line-134">    <span class="token punctuation">}</span></code>
<code class="code-line odd line-135"></code>
<code class="code-line even line-136">    <span class="token keyword">const</span> <span class="token function-variable function">AfterDropFn</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code>
<code class="code-line odd line-137">      <span class="token keyword">const</span> files <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></code>
<code class="code-line even line-138">      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> item <span class="token keyword">of</span> e<span class="token punctuation">.</span>dataTransfer<span class="token punctuation">.</span>items<span class="token punctuation">)</span> <span class="token punctuation">{</span></code>
<code class="code-line odd line-139">        item<span class="token punctuation">.</span>getAsEntry <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-140">          <span class="token keyword">return</span> item<span class="token punctuation">.</span>getAsEntry <span class="token operator">||</span> item<span class="token punctuation">.</span>webkitGetAsEntry</code>
<code class="code-line odd line-141">        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code>
<code class="code-line even line-142">        <span class="token keyword">const</span> entry <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">getAsEntry</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code>
<code class="code-line odd line-143">        files<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token function">getFileFromFolder</span><span class="token punctuation">(</span>entry<span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code>
<code class="code-line even line-144">      <span class="token punctuation">}</span></code>
<code class="code-line odd line-145">      <span class="token keyword">this</span><span class="token punctuation">.</span>callback <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">callback</span><span class="token punctuation">(</span>files<span class="token punctuation">)</span></code>
<code class="code-line even line-146">    <span class="token punctuation">}</span></code>
<code class="code-line odd line-147"></code>
<code class="code-line even line-148">    <span class="token keyword">var</span> canOverBehavior <span class="token operator">=</span> <span class="token boolean">true</span></code>
<code class="code-line odd line-149">    <span class="token keyword">const</span> <span class="token function-variable function">DragEnterFn</span> <span class="token operator">=</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-150">      e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code>
<code class="code-line odd line-151">      onDragEnter <span class="token operator">&amp;&amp;</span> <span class="token function">onDragEnter</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">)</span></code>
<code class="code-line even line-152">      canOverBehavior <span class="token operator">=</span> <span class="token boolean">true</span></code>
<code class="code-line odd line-153">    <span class="token punctuation">}</span></code>
<code class="code-line even line-154">    <span class="token keyword">const</span> <span class="token function-variable function">DragOverFn</span> <span class="token operator">=</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code>
<code class="code-line odd line-155">      e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code>
<code class="code-line even line-156">      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>canOverBehavior<span class="token punctuation">)</span> <span class="token keyword">return</span></code>
<code class="code-line odd line-157">      onDragOver <span class="token operator">&amp;&amp;</span> <span class="token function">onDragOver</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">)</span></code>
<code class="code-line even line-158">      canOverBehavior <span class="token operator">=</span> <span class="token boolean">false</span></code>
<code class="code-line odd line-159">    <span class="token punctuation">}</span></code>
<code class="code-line even line-160">    <span class="token keyword">const</span> <span class="token function-variable function">DragLeaveFn</span> <span class="token operator">=</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code>
<code class="code-line odd line-161">      e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code>
<code class="code-line even line-162">      onDragLeave <span class="token operator">&amp;&amp;</span> <span class="token function">onDragLeave</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">)</span></code>
<code class="code-line odd line-163">      canOverBehavior <span class="token operator">=</span> <span class="token boolean">true</span></code>
<code class="code-line even line-164">    <span class="token punctuation">}</span></code>
<code class="code-line odd line-165">    <span class="token keyword">const</span> <span class="token function-variable function">DropFn</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-166">      e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code>
<code class="code-line odd line-167">      onDrop <span class="token operator">&amp;&amp;</span> <span class="token function">onDrop</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">)</span></code>
<code class="code-line even line-168">      <span class="token keyword">await</span> <span class="token function">AfterDropFn</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span></code>
<code class="code-line odd line-169">      canOverBehavior <span class="token operator">=</span> <span class="token boolean">true</span></code>
<code class="code-line even line-170">    <span class="token punctuation">}</span></code>
<code class="code-line odd line-171">    <span class="token keyword">this</span><span class="token punctuation">.</span>el<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;dragenter&#39;</span><span class="token punctuation">,</span> DragEnterFn<span class="token punctuation">)</span></code>
<code class="code-line even line-172">    <span class="token keyword">this</span><span class="token punctuation">.</span>el<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;dragover&#39;</span><span class="token punctuation">,</span> DragOverFn<span class="token punctuation">)</span></code>
<code class="code-line odd line-173">    <span class="token keyword">this</span><span class="token punctuation">.</span>el<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;dragleave&#39;</span><span class="token punctuation">,</span> DragLeaveFn<span class="token punctuation">)</span></code>
<code class="code-line even line-174">    <span class="token keyword">this</span><span class="token punctuation">.</span>el<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;drop&quot;</span><span class="token punctuation">,</span> DropFn<span class="token punctuation">)</span></code>
<code class="code-line odd line-175"></code>
<code class="code-line even line-176">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">watchElRemove</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code>
<code class="code-line odd line-177">      <span class="token keyword">this</span><span class="token punctuation">.</span>el<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;dragenter&#39;</span><span class="token punctuation">,</span> DragEnterFn<span class="token punctuation">)</span></code>
<code class="code-line even line-178">      <span class="token keyword">this</span><span class="token punctuation">.</span>el<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;dragover&#39;</span><span class="token punctuation">,</span> DragOverFn<span class="token punctuation">)</span></code>
<code class="code-line odd line-179">      <span class="token keyword">this</span><span class="token punctuation">.</span>el<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;dragleave&#39;</span><span class="token punctuation">,</span> DragLeaveFn<span class="token punctuation">)</span></code>
<code class="code-line even line-180">      <span class="token keyword">this</span><span class="token punctuation">.</span>el<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;drop&quot;</span><span class="token punctuation">,</span> DropFn<span class="token punctuation">)</span></code>
<code class="code-line odd line-181">    <span class="token punctuation">}</span><span class="token punctuation">)</span></code>
<code class="code-line even line-182"></code>
<code class="code-line odd line-183">  <span class="token punctuation">}</span></code>
<code class="code-line even line-184"></code>
<code class="code-line odd last-row line-185"><span class="token punctuation">}</span></code></pre></div></div>`,2),c=[p],d={title:null,tags:["upload","\u5355\u6587\u4EF6","\u591A\u6587\u4EF6","\u6587\u4EF6\u5939","\u62D6\u62FD"],categories:null,description:"\u524D\u7AEF\u5C01\u88C5\u4E0A\u4F20\u5355\u6587\u4EF6\uFF0C\u591A\u6587\u4EF6\uFF0C\u6587\u4EF6\u5939\u4EE5\u53CA\u62D6\u62FD\u4E0A\u4F20\uFF01\u5F00\u7BB1\u5373\u7528",publishTime:"2022-08-26T19:00:10.000Z",updateTime:null,img:null,toc:!1,comment:!0},r="",y=s({__name:"index",setup(l,{expose:n}){return n({frontmatter:{title:null,tags:["upload","\u5355\u6587\u4EF6","\u591A\u6587\u4EF6","\u6587\u4EF6\u5939","\u62D6\u62FD"],categories:null,description:"\u524D\u7AEF\u5C01\u88C5\u4E0A\u4F20\u5355\u6587\u4EF6\uFF0C\u591A\u6587\u4EF6\uFF0C\u6587\u4EF6\u5939\u4EE5\u53CA\u62D6\u62FD\u4E0A\u4F20\uFF01\u5F00\u7BB1\u5373\u7528",publishTime:"2022-08-26T19:00:10.000Z",updateTime:null,img:null,toc:!1,comment:!0},excerpt:void 0}),(u,i)=>(a(),e("div",t,c))}});export{y as default,r as excerpt,d as frontmatter};
