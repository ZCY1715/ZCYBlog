import{d as s,o as a,c as e,a as o}from"./@vue.b664db41.js";const t={class:"markdown-body"},c=o(`<h2>\u5B89\u88C5</h2><div class="code-wrapper"><div class="heading-row no-heading show-lang"><span class="lang-display">shell</span></div><div class="code-block language-shell no-line-numbers" data-lang="shell" data-modifiers=""><pre class="language-shell" data-lang="shell"><code class="code-line odd first-row line-1"><span class="token function">npm</span> i file-saver xlsx</code></pre></div></div><h2>\u4EE3\u7801</h2><div class="code-wrapper"><div class="heading-row no-heading show-lang"><span class="lang-display">js</span></div><div class="code-block language-javascript no-line-numbers" data-lang="js" data-modifiers=""><pre class="language-javascript" data-lang="js"><code class="code-line odd first-row line-1"><span class="token keyword">import</span> <span class="token constant">XLSX</span> <span class="token keyword">from</span> <span class="token string">&#39;xlsx&#39;</span></code>
<code class="code-line even line-2"><span class="token keyword">import</span> fileSever <span class="token keyword">from</span> <span class="token string">&#39;file-saver&#39;</span></code>
<code class="code-line odd line-3"></code>
<code class="code-line even line-4"><span class="token comment">/**</span></code>
<code class="code-line odd line-5"> <span class="token operator">*</span> @param data Array\uFF0C\u8868\u4F53\u6570\u636E</code>
<code class="code-line even line-6"> <span class="token operator">*</span> @param key Array\uFF0C\u5B57\u6BB5\u540D</code>
<code class="code-line odd line-7"> <span class="token operator">*</span> @param filename String\uFF0C\u6587\u4EF6\u540D</code>
<code class="code-line even line-8"> <span class="token operator">*</span><span class="token operator">/</span></code>
<code class="code-line odd line-9"><span class="token keyword">export</span> <span class="token keyword">const</span> exportJsonToExcel <span class="token operator">=</span> <span class="token punctuation">(</span></code>
<code class="code-line even line-10">  data<span class="token punctuation">,</span></code>
<code class="code-line odd line-11">  key<span class="token punctuation">,</span></code>
<code class="code-line even line-12">  filename</code>
<code class="code-line odd line-13"><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-14">  <span class="token keyword">const</span> wb <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">book_new</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code>
<code class="code-line odd line-15"></code>
<code class="code-line even line-16">  <span class="token keyword">const</span> ws <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">json_to_sheet</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">{</span></code>
<code class="code-line odd line-17">    <span class="token literal-property property">header</span><span class="token operator">:</span> key<span class="token punctuation">,</span></code>
<code class="code-line even line-18">  <span class="token punctuation">}</span><span class="token punctuation">)</span></code>
<code class="code-line odd line-19"></code>
<code class="code-line even line-20">  <span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">book_append_sheet</span><span class="token punctuation">(</span>wb<span class="token punctuation">,</span> ws<span class="token punctuation">,</span> filename<span class="token punctuation">)</span></code>
<code class="code-line odd line-21">  <span class="token keyword">const</span> wbout <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>wb<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;buffer&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></code>
<code class="code-line even line-22">  <span class="token keyword">const</span> blob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>wbout<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;application/octet-stream&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></code>
<code class="code-line odd line-23">  fileSever<span class="token punctuation">.</span><span class="token function">saveAs</span><span class="token punctuation">(</span>blob<span class="token punctuation">,</span> filename <span class="token operator">+</span> <span class="token string">&#39;.xlsx&#39;</span><span class="token punctuation">)</span></code>
<code class="code-line even line-24"><span class="token punctuation">}</span></code>
<code class="code-line odd line-25"></code>
<code class="code-line even line-26"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">importExcel</span><span class="token punctuation">(</span><span class="token parameter">file<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code>
<code class="code-line odd line-27">  <span class="token keyword">const</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code>
<code class="code-line even line-28">  reader<span class="token punctuation">.</span><span class="token function">readAsArrayBuffer</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span></code>
<code class="code-line odd line-29">  reader<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code>
<code class="code-line even line-30">    <span class="token keyword">const</span> context <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>reader<span class="token punctuation">.</span>result<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;buffer&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code>
<code class="code-line odd line-31">    <span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">sheet_to_json</span><span class="token punctuation">(</span></code>
<code class="code-line even line-32">      context<span class="token punctuation">.</span>Sheets<span class="token punctuation">[</span>context<span class="token punctuation">.</span>SheetNames<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span></code>
<code class="code-line odd line-33">    <span class="token punctuation">)</span></code>
<code class="code-line even line-34">    callback <span class="token operator">&amp;&amp;</span> <span class="token function">callback</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span></code>
<code class="code-line odd line-35">  <span class="token punctuation">}</span></code>
<code class="code-line even last-row line-36"><span class="token punctuation">}</span></code></pre></div></div>`,4),p=[c],r={title:null,tags:["excel","xlsx","filer-serve"],categories:null,description:"\u524D\u7AEF\u8BFB\u53D6\u4E0E\u4FDD\u5B58\u4E3A excel \u6587\u4EF6, \u4F7F\u7528\u4E86 xlsx \u4E0E file-sever \u8FD9\u4E24\u4E2A\u5E93",publishTime:"2022-08-26T02:06:50.000Z",updateTime:null,img:null,toc:!1,comment:!0},k="",f=s({__name:"index",setup(l,{expose:n}){return n({frontmatter:{title:null,tags:["excel","xlsx","filer-serve"],categories:null,description:"\u524D\u7AEF\u8BFB\u53D6\u4E0E\u4FDD\u5B58\u4E3A excel \u6587\u4EF6, \u4F7F\u7528\u4E86 xlsx \u4E0E file-sever \u8FD9\u4E24\u4E2A\u5E93",publishTime:"2022-08-26T02:06:50.000Z",updateTime:null,img:null,toc:!1,comment:!0},excerpt:void 0}),(i,u)=>(a(),e("div",t,p))}});export{f as default,k as excerpt,r as frontmatter};
